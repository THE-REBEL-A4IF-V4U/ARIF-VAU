const axios = require('axios');
const request = require('request');
const fs = require('fs-extra');
const moment = require('moment-timezone');

module.exports.config = {
  name: "time",
  version: "1.1.1",
  permission: 0,
  credits: "rebel",
  description: "Show current time and a random quote",
  prefix: false,
  category: "without prefix",
  usage: "time",
  cooldowns: 3,
  dependency: { "axios": "", "fs-extra": "" }
};

module.exports.run = async function({ api, event }) {
  try {
    const quotes = [
      'ржЕржирзЗржХ ржХрж┐ржЫрзБ ржлрж┐рж░рзЗ ржЖрж╕рзЗ ржХрж┐ржирзНрждрзБ рж╕ржоржпрж╝ржХрзЗ ржлрж┐рж░рж┐ржпрж╝рзЗ ржЖржирж╛ ржпрж╛ржпрж╝ ржирж╛ ред',
      'ржЖржорж┐ рждрзЛржорж╛ржжрзЗрж░ ржмрж▓рзЗржЫрж┐ ржпрзЗ рждрзЛржорж░рж╛ ржорж┐ржирж┐ржЯрзЗрж░ ржЦрзЗржпрж╝рж╛рж▓ рж░рж╛ржЦрзЛ, рждрж╛рж╣рж▓рзЗ ржжрзЗржЦржмрзЗ ржШржирзНржЯрж╛ржЧрзБрж▓рзЛ ржЖржкржирж╛ ржерзЗржХрзЗржЗ ржирж┐ржЬрзЗржжрзЗрж░ ржЦрзЗржпрж╝рж╛рж▓ рж░рж╛ржЦржЫрзЗ ред',
      'ржмржбрж╝ рж╣рждрзЗ рж╣рж▓рзЗ рж╕рж░рзНржмржкрзНрж░ржержо рж╕ржоржпрж╝рзЗрж░ ржорзВрж▓рзНржп ржжрж┐рждрзЗ рж╣ржмрзЗ ред',
      'ржорж╛ржирзБрж╖рзЗрж░ ржХржпрж╝рж▓рж╛ ржирж╛ржорзНржмрж╛рж░ рж╢рждрзНрж░рзБ рж╣рж▓ рж╕ржоржпрж╝ ред',
      'рж╕ржоржпрж╝ ржЪрж▓рзЗ ржпрж╛ржпрж╝ ржирж╛ ржЖржорж░рж╛ржЗ ржЪрж▓рзЗ ржпрж╛ржЗ ред',
      'рж╕ржоржпрж╝ ржжрзНрж░рзБржд ржЪрж▓рзЗ ржпрж╛ржпрж╝, ржПрж░ рж╕ржжрзНржмрзНржпржмрж╣рж╛рж░ ржпрж╛рж░рж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗ рждрж╛рж░рж╛ржЗ рж╕ржлрж▓ ржУ рж╕рж╛рж░рзНржержХ ржмрж▓рзЗ ржкрж░рж┐ржЪрж┐ржд рж╣ржпрж╝ ред',
      'рж╕ржоржпрж╝рзЗрж░ рж╕ржорзБржжрзНрж░рзЗ ржЖржЫрж┐, ржХрж┐ржирзНрждрзБ ржПржХржорзБрж╣рзВрж░рзНржд рж╕ржоржпрж╝ ржирзЗржЗ ред',
      'рждрзЛржорж╛рж░ рж╕ржоржпрж╝ ржпржд ржмржЫрж░ рждржд ржмржЫрж░ ржХрж┐ рждрзБржорж┐ ржмрзЗржБржЪрзЗржЫрж┐рж▓рзЗ ?',
      'ржЬрзАржмржи ржПржмржВ рж╕ржоржпрж╝ ржкрзГржерж┐ржмрзАрж░ рж╢рзНрж░рзЗрж╖рзНржа рж╢рж┐ржХрзНрж╖ржХ, ржЬрзАржмржи рж╢рзЗржЦрж╛ржпрж╝ рж╕ржоржпрж╝ржХрзЗ ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ , рж╕ржоржпрж╝ рж╢рзЗржЦрж╛ржпрж╝ ржЬрзАржмржирзЗрж░ ржорзВрж▓рзНржп ржжрж┐рждрзЗ ред',
      'рж╕ржоржпрж╝ ржирзЗрждрж╛ рждрзИрж░рж┐ ржХрж░рзЗ, ржарж┐ржХ рж╕ржоржпрж╝рзЗ ржарж┐ржХ ржирзЗрждрж╛ ржПржЗ ржХрж╛рж░ржгрзЗржЗ ржмрзЗрж░ рж╣ржпрж╝рзЗ ржЖрж╕рзЗ ред',
      'ржЖржкржирж╛рж░ ржЬрзАржмржирзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржорзБрж╣рзВрж░рзНрждржЗ ржЖржкржирж╛рж░ ржнржмрж┐рж╖рзНржпрзО ржХрзЗ рж░рзВржкржжрж╛ржирзЗ ржХрж╛ржЬ ржХрж░рзЗ , рж╕рзБрждрж░рж╛ржВ ржЬрзАржмржирзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржорзБрж╣рзВрж░рзНржд ржХрзЗржЗ рж╕ржарж┐ржХржнрж╛ржмрзЗ ржХрж╛ржЬрзЗ рж▓рж╛ржЧрж╛ржирзЛрж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи ред',
      'рж╕ржорж╕рзНржд ржЬрж┐ржирж┐рж╕рзЗрж░ ржЬржирзНржп ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржоржпрж╝ ржЖржЫрзЗ ред',
      'ржирж┐ржЬрзЗрж░ ржЪрж┐ржирзНрждрж╛ржХрзЗ рж╕рж░рж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржкрж░рж┐рж╖рзНржХрж╛рж░ржнрж╛ржмрзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рждрзЗ ржЖржкржирж╛ржХрзЗ ржХржарзЛрж░ ржкрж░рж┐рж╢рзНрж░ржо ржХрж░рждрзЗ рж╣ржмрзЗред ржХрж╛рж░ржг ржкрж░рж┐рж╖рзНржХрж╛рж░ржнрж╛ржмрзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рждрзЗ ржкрж╛рж░рж╛ржЯрж╛ржЗ рж╕ржмржЪрзЗржпрж╝рзЗ ржмржбрж╝ ржХржерж╛ ред',
      'ржЙржжрзНржнрж╛ржмржирзА ржПржХржЬржи ржирзЗрждрж╛ ржУ ржПржХржЬржи ржЕржирзБрж╕рж░ржгржХрж╛рж░рзАрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп рждрзИрж░рж┐ ржХрж░рзЗ ржжрзЗржпрж╝ ред',
      'ржЕрж╕рж╛ржзрж╛рж░ржг рж╕ржм ржХрж╛ржЬ ржХрж░рзБржи ржПржмржВ рж╕рж╛ржоржирзЗ ржПржЧрж┐ржпрж╝рзЗ ржпрж╛ржи, ржЖржорж┐ ржоржирзЗ ржХрж░рж┐ ржЖржкржирж┐ ржпржжрж┐ ржПржоржи ржХрзЛржирзЛ ржХрж╛ржЬ ржХрж░рзЗржи ржпрж╛ ржкрзНрж░рж╢ржВрж╕рж╛ ржХрзБржбрж╝рж╛ржпрж╝ рждрж╛рж╣рж▓рзЗ ржЖржкржирж╛рж░ ржЙржЪрж┐ржд ржЖрж░рзЛ ржнрж╛рж▓рзЛ ржХрзЛржи ржХрж╛ржЬ ржХрж░рж╛ред',
      'ржЖржкржирж╛рж░ рж╢рж╛рж░рзАрж░рж┐ржХ ржЕржХрзНрж╖ржорждрж╛ ржирж┐ржпрж╝рзЗ ржХрзЛржи ржЕржнрж┐ржпрзЛржЧ ржХрж░ржмрзЗржи ржирж╛ ржмрж╛ рждрж╛рж░ ржХрж╛рж░ржг ржЦрзБржБржЬрждрзЗ ржЧрж┐ржпрж╝рзЗ ржЖржкржирж╛рж░ ржЕржорзВрж▓рзНржп рж╕ржоржпрж╝ ржирж╖рзНржЯ ржХрж░ржмрзЗржи ржирж╛, ржЖржкржирж╛рж░ ржпрж╛ ржХрж┐ржЫрзБ ржнрзЗрждрж░рзЗрж░ рж╢ржХрзНрждрж┐ ржерж╛ржХрзЗ рждрж╛ ржжрж┐ржпрж╝рзЗ ржЕржирзНржпржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзБржи ржмрж╛ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи ред'
    ];

    const images = [
      "https://i.postimg.cc/Kvnvtcfn/In-Shot-20230221-121841892.gif",
      "https://i.postimg.cc/W3P5Fn1m/In-Shot-20230221-121801665.gif",
      "https://i.postimg.cc/kgsSFvsF/In-Shot-20230221-121241570.gif"
    ];

    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
    const randomImage = images[Math.floor(Math.random() * images.length)];
    const currentTime = moment.tz("Asia/Dhaka").format("┬╗ рждрж╛рж░рж┐ржЦ: D/MM/YYYY ┬л  { рж╕ржорзЯ: HH:mm:ss }");

    const filePath = __dirname + "/cache/juswa.gif";

    const downloadImage = () => new Promise((resolve, reject) => {
      request(encodeURI(randomImage))
        .pipe(fs.createWriteStream(filePath))
        .on("close", resolve)
        .on("error", reject);
    });

    await downloadImage();

    api.sendMessage({
      body: `~ржЖржБрж╕рзНрж╕рж╛ржБрж▓рж╛ржБржорзБржБ-ржЖрж▓рж╛ржЗржХрзБржоЁЯЦд >>\n\nржЖржЬржХрзЗрж░ рждрж╛рж░рж┐ржЦ ржПржмржВ рж╕ржорзЯ:\n${currentTime}\n\nFacebook Link: https://www.facebook.com/THE.R3B3L.ARIF.VAU\n\n*************************************\n┬╗ ${randomQuote} ┬л\nЁЭЩ▒ЁЭЩ╛ЁЭЪГ ЁЭЩ╛ЁЭЪЖЁЭЩ╜ЁЭЩ┤ЁЭЪБ: ЁЭЧФЁЭЧеЁЭЧЬЁЭЧЩЁЭЧиЁЭЧЯ ЁЭЧЬЁЭЧжЁЭЧЯЁЭЧФЁЭЧа ЁЭЧФЁЭЧжЁЭЧЬЁЭЧЩ\n*************************************`,
      attachment: fs.createReadStream(filePath)
    }, event.threadID, () => fs.unlinkSync(filePath));

  } catch (error) {
    console.error(error);
    api.sendMessage("ржХрж┐ржЫрзБ ржПржХржЯрж╛ ржнрзБрж▓ рж╣ржпрж╝рзЗржЫрзЗред ржжржпрж╝рж╛ ржХрж░рзЗ ржкрж░рзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред", event.threadID);
  }
};
